nohup: ignoring input
Config (path: configs/260127/qwenimage_fulltune_5000.py): {'seed': 42, 'device': 'cuda', 'dtype': 'float32', 'revision': None, 'variant': None, 'bnb_quantization_config_path': None, 'model_type': 'QwenImage', 'transformer_cfg': {'type': 'QwenImageTransformer2DModel'}, 'pretrained_model_name_or_path': 'Qwen/Qwen-Image-2512', 'huggingface_token': None, 'use_lora': False, 'lora_layers': 'to_k,to_q,to_v', 'rank': 64, 'lora_alpha': 4, 'lora_dropout': 0.0, 'layer_weighting': 5.0, 'pos_embedding': 'rope', 'decoder_arch': 'vit', 'use_parquet_dataset': True, 'train_batch_size': 1, 'num_train_epochs': 100, 'max_train_steps': 5000, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'cache_latents': False, 'optimizer': 'adamw', 'use_8bit_adam': False, 'learning_rate': 5e-06, 'lr_scheduler': 'cosine', 'lr_warmup_steps': 100, 'adam_beta1': 0.9, 'adam_beta2': 0.999, 'adam_weight_decay': 0.01, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'prodigy_beta3': None, 'prodigy_decouple': True, 'prodigy_use_bias_correction': True, 'prodigy_safeguard_warmup': True, 'checkpointing_steps': 500, 'resume_from_checkpoint': None, 'checkpoints_total_limit': 5, 'mixed_precision': 'bf16', 'allow_tf32': True, 'upcast_before_saving': False, 'offload': False, 'report_to': 'wandb', 'push_to_hub': False, 'hub_token': None, 'hub_model_id': None, 'cache_dir': '/home/v-yuxluo/data/huggingface_cache', 'scale_lr': False, 'lr_num_cycles': 1, 'lr_power': 1.0, 'weighting_scheme': 'logit_normal', 'logit_mean': 0.0, 'logit_std': 1.0, 'mode_scale': 1.29, 'validation_guidance_scale': 1.0, 'base_filesys_path': '/home/v-yuxluo/data/', 'dataset_cfg': {'type': 'ArXiVParquetDatasetV2', 'base_dir': '/home/v-yuxluo/data/', 'parquet_base_path': 'ArXiV_parquet/qwenimage_latents', 'num_workers': 2, 'num_train_examples': None, 'debug_mode': False, 'is_main_process': True, 'stat_data': False}, 'sampler_cfg': {'type': 'DistributedBucketSamplerV2', 'dataset': None, 'batch_size': 1, 'num_replicas': None, 'rank': None, 'drop_last': True, 'shuffle': True}, 'train_iteration_func': 'QwenImage_fulltune_train_iteration', 'validation_steps': 500, 'max_sequence_length': 1024, 'dataloader_num_workers': 2, 'pin_memory': True, 'num_inference_steps': 50, 'model_output_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps', 'output_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps', 'log_steps': 10, 'verbose_logging': True, 'logging_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps/logs', 'wandb_project': 'QwenImage-20B-FullTune', 'tracker_run_name': '260127_qwenimage_5000steps', 'validation_prompts': ['A scientific diagram showing a neural network architecture with multiple layers', 'A chart comparing machine learning algorithms performance'], 'resolution_list': [[768, 768], [768, 768]], 'config_dir': 'configs/260127/qwenimage_fulltune_5000.py'}
Config (path: configs/260127/qwenimage_fulltune_5000.py): {'seed': 42, 'device': 'cuda', 'dtype': 'float32', 'revision': None, 'variant': None, 'bnb_quantization_config_path': None, 'model_type': 'QwenImage', 'transformer_cfg': {'type': 'QwenImageTransformer2DModel'}, 'pretrained_model_name_or_path': 'Qwen/Qwen-Image-2512', 'huggingface_token': None, 'use_lora': False, 'lora_layers': 'to_k,to_q,to_v', 'rank': 64, 'lora_alpha': 4, 'lora_dropout': 0.0, 'layer_weighting': 5.0, 'pos_embedding': 'rope', 'decoder_arch': 'vit', 'use_parquet_dataset': True, 'train_batch_size': 1, 'num_train_epochs': 100, 'max_train_steps': 5000, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'cache_latents': False, 'optimizer': 'adamw', 'use_8bit_adam': False, 'learning_rate': 5e-06, 'lr_scheduler': 'cosine', 'lr_warmup_steps': 100, 'adam_beta1': 0.9, 'adam_beta2': 0.999, 'adam_weight_decay': 0.01, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'prodigy_beta3': None, 'prodigy_decouple': True, 'prodigy_use_bias_correction': True, 'prodigy_safeguard_warmup': True, 'checkpointing_steps': 500, 'resume_from_checkpoint': None, 'checkpoints_total_limit': 5, 'mixed_precision': 'bf16', 'allow_tf32': True, 'upcast_before_saving': False, 'offload': False, 'report_to': 'wandb', 'push_to_hub': False, 'hub_token': None, 'hub_model_id': None, 'cache_dir': '/home/v-yuxluo/data/huggingface_cache', 'scale_lr': False, 'lr_num_cycles': 1, 'lr_power': 1.0, 'weighting_scheme': 'logit_normal', 'logit_mean': 0.0, 'logit_std': 1.0, 'mode_scale': 1.29, 'validation_guidance_scale': 1.0, 'base_filesys_path': '/home/v-yuxluo/data/', 'dataset_cfg': {'type': 'ArXiVParquetDatasetV2', 'base_dir': '/home/v-yuxluo/data/', 'parquet_base_path': 'ArXiV_parquet/qwenimage_latents', 'num_workers': 2, 'num_train_examples': None, 'debug_mode': False, 'is_main_process': True, 'stat_data': False}, 'sampler_cfg': {'type': 'DistributedBucketSamplerV2', 'dataset': None, 'batch_size': 1, 'num_replicas': None, 'rank': None, 'drop_last': True, 'shuffle': True}, 'train_iteration_func': 'QwenImage_fulltune_train_iteration', 'validation_steps': 500, 'max_sequence_length': 1024, 'dataloader_num_workers': 2, 'pin_memory': True, 'num_inference_steps': 50, 'model_output_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps', 'output_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps', 'log_steps': 10, 'verbose_logging': True, 'logging_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps/logs', 'wandb_project': 'QwenImage-20B-FullTune', 'tracker_run_name': '260127_qwenimage_5000steps', 'validation_prompts': ['A scientific diagram showing a neural network architecture with multiple layers', 'A chart comparing machine learning algorithms performance'], 'resolution_list': [[768, 768], [768, 768]], 'config_dir': 'configs/260127/qwenimage_fulltune_5000.py'}
Config (path: configs/260127/qwenimage_fulltune_5000.py): {'seed': 42, 'device': 'cuda', 'dtype': 'float32', 'revision': None, 'variant': None, 'bnb_quantization_config_path': None, 'model_type': 'QwenImage', 'transformer_cfg': {'type': 'QwenImageTransformer2DModel'}, 'pretrained_model_name_or_path': 'Qwen/Qwen-Image-2512', 'huggingface_token': None, 'use_lora': False, 'lora_layers': 'to_k,to_q,to_v', 'rank': 64, 'lora_alpha': 4, 'lora_dropout': 0.0, 'layer_weighting': 5.0, 'pos_embedding': 'rope', 'decoder_arch': 'vit', 'use_parquet_dataset': True, 'train_batch_size': 1, 'num_train_epochs': 100, 'max_train_steps': 5000, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'cache_latents': False, 'optimizer': 'adamw', 'use_8bit_adam': False, 'learning_rate': 5e-06, 'lr_scheduler': 'cosine', 'lr_warmup_steps': 100, 'adam_beta1': 0.9, 'adam_beta2': 0.999, 'adam_weight_decay': 0.01, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'prodigy_beta3': None, 'prodigy_decouple': True, 'prodigy_use_bias_correction': True, 'prodigy_safeguard_warmup': True, 'checkpointing_steps': 500, 'resume_from_checkpoint': None, 'checkpoints_total_limit': 5, 'mixed_precision': 'bf16', 'allow_tf32': True, 'upcast_before_saving': False, 'offload': False, 'report_to': 'wandb', 'push_to_hub': False, 'hub_token': None, 'hub_model_id': None, 'cache_dir': '/home/v-yuxluo/data/huggingface_cache', 'scale_lr': False, 'lr_num_cycles': 1, 'lr_power': 1.0, 'weighting_scheme': 'logit_normal', 'logit_mean': 0.0, 'logit_std': 1.0, 'mode_scale': 1.29, 'validation_guidance_scale': 1.0, 'base_filesys_path': '/home/v-yuxluo/data/', 'dataset_cfg': {'type': 'ArXiVParquetDatasetV2', 'base_dir': '/home/v-yuxluo/data/', 'parquet_base_path': 'ArXiV_parquet/qwenimage_latents', 'num_workers': 2, 'num_train_examples': None, 'debug_mode': False, 'is_main_process': True, 'stat_data': False}, 'sampler_cfg': {'type': 'DistributedBucketSamplerV2', 'dataset': None, 'batch_size': 1, 'num_replicas': None, 'rank': None, 'drop_last': True, 'shuffle': True}, 'train_iteration_func': 'QwenImage_fulltune_train_iteration', 'validation_steps': 500, 'max_sequence_length': 1024, 'dataloader_num_workers': 2, 'pin_memory': True, 'num_inference_steps': 50, 'model_output_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps', 'output_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps', 'log_steps': 10, 'verbose_logging': True, 'logging_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps/logs', 'wandb_project': 'QwenImage-20B-FullTune', 'tracker_run_name': '260127_qwenimage_5000steps', 'validation_prompts': ['A scientific diagram showing a neural network architecture with multiple layers', 'A chart comparing machine learning algorithms performance'], 'resolution_list': [[768, 768], [768, 768]], 'config_dir': 'configs/260127/qwenimage_fulltune_5000.py'}
Config (path: configs/260127/qwenimage_fulltune_5000.py): {'seed': 42, 'device': 'cuda', 'dtype': 'float32', 'revision': None, 'variant': None, 'bnb_quantization_config_path': None, 'model_type': 'QwenImage', 'transformer_cfg': {'type': 'QwenImageTransformer2DModel'}, 'pretrained_model_name_or_path': 'Qwen/Qwen-Image-2512', 'huggingface_token': None, 'use_lora': False, 'lora_layers': 'to_k,to_q,to_v', 'rank': 64, 'lora_alpha': 4, 'lora_dropout': 0.0, 'layer_weighting': 5.0, 'pos_embedding': 'rope', 'decoder_arch': 'vit', 'use_parquet_dataset': True, 'train_batch_size': 1, 'num_train_epochs': 100, 'max_train_steps': 5000, 'gradient_accumulation_steps': 2, 'gradient_checkpointing': True, 'cache_latents': False, 'optimizer': 'adamw', 'use_8bit_adam': False, 'learning_rate': 5e-06, 'lr_scheduler': 'cosine', 'lr_warmup_steps': 100, 'adam_beta1': 0.9, 'adam_beta2': 0.999, 'adam_weight_decay': 0.01, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'prodigy_beta3': None, 'prodigy_decouple': True, 'prodigy_use_bias_correction': True, 'prodigy_safeguard_warmup': True, 'checkpointing_steps': 500, 'resume_from_checkpoint': None, 'checkpoints_total_limit': 5, 'mixed_precision': 'bf16', 'allow_tf32': True, 'upcast_before_saving': False, 'offload': False, 'report_to': 'wandb', 'push_to_hub': False, 'hub_token': None, 'hub_model_id': None, 'cache_dir': '/home/v-yuxluo/data/huggingface_cache', 'scale_lr': False, 'lr_num_cycles': 1, 'lr_power': 1.0, 'weighting_scheme': 'logit_normal', 'logit_mean': 0.0, 'logit_std': 1.0, 'mode_scale': 1.29, 'validation_guidance_scale': 1.0, 'base_filesys_path': '/home/v-yuxluo/data/', 'dataset_cfg': {'type': 'ArXiVParquetDatasetV2', 'base_dir': '/home/v-yuxluo/data/', 'parquet_base_path': 'ArXiV_parquet/qwenimage_latents', 'num_workers': 2, 'num_train_examples': None, 'debug_mode': False, 'is_main_process': True, 'stat_data': False}, 'sampler_cfg': {'type': 'DistributedBucketSamplerV2', 'dataset': None, 'batch_size': 1, 'num_replicas': None, 'rank': None, 'drop_last': True, 'shuffle': True}, 'train_iteration_func': 'QwenImage_fulltune_train_iteration', 'validation_steps': 500, 'max_sequence_length': 1024, 'dataloader_num_workers': 2, 'pin_memory': True, 'num_inference_steps': 50, 'model_output_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps', 'output_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps', 'log_steps': 10, 'verbose_logging': True, 'logging_dir': '/home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps/logs', 'wandb_project': 'QwenImage-20B-FullTune', 'tracker_run_name': '260127_qwenimage_5000steps', 'validation_prompts': ['A scientific diagram showing a neural network architecture with multiple layers', 'A chart comparing machine learning algorithms performance'], 'resolution_list': [[768, 768], [768, 768]], 'config_dir': 'configs/260127/qwenimage_fulltune_5000.py'}
01/27/2026 02:01:07 - INFO - __main__ - Distributed environment: FSDP  Backend: cuda:nccl,cpu:gloo
Num processes: 4
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: bf16

01/27/2026 02:01:07 - INFO - __main__ - [INFO] Using model type: QwenImage
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory - ============================================================
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory - üè≠ Model Factory Initialized
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory -    Model Type: QwenImage
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory -    Pretrained Path: Qwen/Qwen-Image-2512
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory -    Cache Dir: /home/v-yuxluo/data/huggingface_cache
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory -    VAE Class: AutoencoderKLQwenImage
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory -    Transformer Class: QwenImageTransformer2DModel
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory -    Text Encoder Class: Qwen2_5_VLForConditionalGeneration
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory -    Pipeline Class: QwenImagePipeline
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory - ============================================================
01/27/2026 02:01:07 - INFO - OpenSciDraw.utils.model_factory - [INFO] Loading tokenizer: Qwen2Tokenizer
01/27/2026 02:01:07 - INFO - __main__ - Distributed environment: FSDP  Backend: cuda:nccl,cpu:gloo
Num processes: 4
Process index: 2
Local process index: 2
Device: cuda:2

Mixed precision type: bf16

01/27/2026 02:01:07 - INFO - __main__ - Distributed environment: FSDP  Backend: cuda:nccl,cpu:gloo
Num processes: 4
Process index: 3
Local process index: 3
Device: cuda:3

Mixed precision type: bf16

01/27/2026 02:01:07 - INFO - __main__ - Distributed environment: FSDP  Backend: cuda:nccl,cpu:gloo
Num processes: 4
Process index: 1
Local process index: 1
Device: cuda:1

Mixed precision type: bf16

01/27/2026 02:01:08 - INFO - OpenSciDraw.utils.model_factory - [INFO] Loading text encoder: Qwen2_5_VLForConditionalGeneration
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 127.53it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 334.01it/s]
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:00<00:00, 277.98it/s]

Loading checkpoint shards:  25%|‚ñà‚ñà‚ñå       | 1/4 [00:01<00:03,  1.16s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 2/4 [00:01<00:01,  1.36it/s]Loading checkpoint shards:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 3/4 [00:01<00:00,  1.75it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 4/4 [00:02<00:00,  1.99it/s]
01/27/2026 02:01:10 - INFO - OpenSciDraw.utils.model_factory - [INFO] Loading VAE: AutoencoderKLQwenImage
{'input_channels'} was not found in config. Values will be initialized to default values.
All model checkpoint weights were used when initializing AutoencoderKLQwenImage.

All the weights of AutoencoderKLQwenImage were initialized from the model checkpoint at Qwen/Qwen-Image-2512.
If your task is similar to the task the model of the checkpoint was trained on, you can already use AutoencoderKLQwenImage for predictions without further training.
01/27/2026 02:01:13 - INFO - OpenSciDraw.utils.model_factory - [INFO] Loading transformer: QwenImageTransformer2DModel
Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 9/9 [00:00<00:00, 5050.00it/s]
Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 9/9 [00:00<00:00, 8614.50it/s]
Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 9/9 [00:00<00:00, 6192.38it/s]
Fetching 9 files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 9/9 [00:00<00:00, 8732.07it/s]
Instantiating QwenImageTransformer2DModel model under default dtype torch.bfloat16.
{'zero_cond_t', 'use_additional_t_cond', 'use_layer3d_rope'} was not found in config. Values will be initialized to default values.
Loading checkpoint shards:   0%|          | 0/9 [00:00<?, ?it/s]Loading checkpoint shards:  11%|‚ñà         | 1/9 [00:00<00:04,  1.65it/s]Loading checkpoint shards:  22%|‚ñà‚ñà‚ñè       | 2/9 [00:01<00:03,  1.82it/s]Loading checkpoint shards:  33%|‚ñà‚ñà‚ñà‚ñé      | 3/9 [00:01<00:03,  1.97it/s]Loading checkpoint shards:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 4/9 [00:02<00:02,  2.03it/s]Loading checkpoint shards:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 5/9 [00:02<00:02,  2.00it/s]Loading checkpoint shards:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 6/9 [00:03<00:01,  2.06it/s]Loading checkpoint shards:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 7/9 [00:03<00:00,  2.10it/s]Loading checkpoint shards:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 8/9 [00:03<00:00,  2.06it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 9/9 [00:04<00:00,  2.71it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 9/9 [00:04<00:00,  2.20it/s]
All model checkpoint weights were used when initializing QwenImageTransformer2DModel.

All the weights of QwenImageTransformer2DModel were initialized from the model checkpoint at Qwen/Qwen-Image-2512.
If your task is similar to the task the model of the checkpoint was trained on, you can already use QwenImageTransformer2DModel for predictions without further training.
01/27/2026 02:01:18 - INFO - OpenSciDraw.utils.model_factory - [INFO] Fine-tuning the full model ...
01/27/2026 02:01:18 - INFO - OpenSciDraw.utils.model_factory - [INFO] Enabling gradient checkpointing for transformer
01/27/2026 02:01:18 - INFO - OpenSciDraw.utils.model_factory - [INFO] Loading scheduler: FlowMatchEulerDiscreteScheduler
01/27/2026 02:01:18 - INFO - OpenSciDraw.utils.model_factory - [INFO] Loading text encoding pipeline: QwenImagePipeline
Loading pipeline components...:   0%|          | 0/2 [00:00<?, ?it/s]Loading pipeline components...: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:00<00:00, 3054.85it/s]
01/27/2026 02:01:18 - INFO - OpenSciDraw.utils.model_factory - [INFO] VAE scale factor: 8
01/27/2026 02:01:18 - INFO - __main__ - [INFO] FSDP detected - keeping transformer in bf16 for pure bf16 training
01/27/2026 02:01:19 - INFO - __main__ - [INFO] Configuring model devices and offloading
01/27/2026 02:01:19 - INFO - __main__ - [INFO] Using parquet dataset - VAE and text encoder remain on CPU
01/27/2026 02:01:19 - INFO - __main__ - [INFO] FSDP mode: transformer stays on CPU, accelerator.prepare will handle placement
01/27/2026 02:01:19 - INFO - __main__ - [INFO] Gradient checkpointing enabled
01/27/2026 02:01:19 - INFO - __main__ - [INFO] Number of trainable parameters: 20430.40M
01/27/2026 02:01:19 - INFO - __main__ - [INFO] Loading dataset
/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/mmengine/optim/optimizer/zero_optimizer.py:11: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import \
üîç Building metadata from all parquet files in /home/v-yuxluo/data/ArXiV_parquet/qwenimage_latents...
/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/mmengine/optim/optimizer/zero_optimizer.py:11: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import \
üîç Building metadata from all parquet files in /home/v-yuxluo/data/ArXiV_parquet/qwenimage_latents...
/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/mmengine/optim/optimizer/zero_optimizer.py:11: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import \
üîç Building metadata from all parquet files in /home/v-yuxluo/data/ArXiV_parquet/qwenimage_latents...
/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/mmengine/optim/optimizer/zero_optimizer.py:11: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import \
üîç Building metadata from all parquet files in /home/v-yuxluo/data/ArXiV_parquet/qwenimage_latents...
‚è≥ Loading/parsing metadata (parquet: path only) from 84 parquet files...‚è≥ Loading/parsing metadata (parquet: path only) from 84 parquet files...

‚è≥ Loading/parsing metadata (parquet: path only) from 84 parquet files...
‚è≥ Loading/parsing metadata (parquet: path only) from 84 parquet files...
Scanning Parquet Files:   0%|          | 0/84 [00:00<?, ?it/s]Scanning Parquet Files:   0%|          | 0/84 [00:00<?, ?it/s]Scanning Parquet Files:   0%|          | 0/84 [00:00<?, ?it/s]Scanning Parquet Files:   4%|‚ñé         | 3/84 [00:00<00:02, 29.92it/s]Scanning Parquet Files:   0%|          | 0/84 [00:00<?, ?it/s]Scanning Parquet Files:   6%|‚ñå         | 5/84 [00:00<00:01, 49.88it/s]Scanning Parquet Files:   1%|          | 1/84 [00:00<00:30,  2.70it/s]Scanning Parquet Files:  15%|‚ñà‚ñå        | 13/84 [00:00<00:01, 68.74it/s]Scanning Parquet Files:  15%|‚ñà‚ñå        | 13/84 [00:00<00:00, 128.96it/s]Scanning Parquet Files:  20%|‚ñà‚ñà        | 17/84 [00:00<00:00, 67.14it/s]Scanning Parquet Files:  20%|‚ñà‚ñà        | 17/84 [00:00<00:01, 40.81it/s]Scanning Parquet Files:  24%|‚ñà‚ñà‚ñç       | 20/84 [00:00<00:01, 54.59it/s]Scanning Parquet Files:  29%|‚ñà‚ñà‚ñä       | 24/84 [00:00<00:01, 33.61it/s]Scanning Parquet Files:  29%|‚ñà‚ñà‚ñä       | 24/84 [00:00<00:01, 41.28it/s]Scanning Parquet Files:  31%|‚ñà‚ñà‚ñà       | 26/84 [00:00<00:01, 41.01it/s] Scanning Parquet Files:  31%|‚ñà‚ñà‚ñà       | 26/84 [00:00<00:01, 33.22it/s]Scanning Parquet Files:  35%|‚ñà‚ñà‚ñà‚ñç      | 29/84 [00:00<00:01, 33.64it/s]Scanning Parquet Files:  35%|‚ñà‚ñà‚ñà‚ñç      | 29/84 [00:01<00:01, 29.45it/s]Scanning Parquet Files:  37%|‚ñà‚ñà‚ñà‚ñã      | 31/84 [00:00<00:01, 31.48it/s]Scanning Parquet Files:  39%|‚ñà‚ñà‚ñà‚ñâ      | 33/84 [00:00<00:01, 33.90it/s]Scanning Parquet Files:  39%|‚ñà‚ñà‚ñà‚ñâ      | 33/84 [00:00<00:01, 37.47it/s]Scanning Parquet Files:  39%|‚ñà‚ñà‚ñà‚ñâ      | 33/84 [00:01<00:01, 30.39it/s]Scanning Parquet Files:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 35/84 [00:00<00:01, 30.98it/s]Scanning Parquet Files:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 37/84 [00:01<00:01, 27.02it/s]Scanning Parquet Files:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 37/84 [00:01<00:01, 27.79it/s]Scanning Parquet Files:  46%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 39/84 [00:01<00:01, 26.19it/s]Scanning Parquet Files:  46%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 39/84 [00:01<00:01, 29.24it/s]Scanning Parquet Files:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 41/84 [00:01<00:01, 25.18it/s]Scanning Parquet Files:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 41/84 [00:01<00:01, 26.11it/s]Scanning Parquet Files:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 43/84 [00:01<00:01, 24.61it/s]Scanning Parquet Files:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 44/84 [00:01<00:01, 26.74it/s]Scanning Parquet Files:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 43/84 [00:01<00:01, 27.64it/s]Scanning Parquet Files:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 44/84 [00:01<00:01, 25.83it/s]Scanning Parquet Files:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 47/84 [00:01<00:01, 26.67it/s]Scanning Parquet Files:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 47/84 [00:01<00:01, 26.37it/s]Scanning Parquet Files:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 47/84 [00:01<00:01, 28.80it/s]Scanning Parquet Files:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 47/84 [00:01<00:01, 25.71it/s]Scanning Parquet Files:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 50/84 [00:01<00:01, 27.04it/s]Scanning Parquet Files:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 50/84 [00:01<00:01, 26.92it/s]Scanning Parquet Files:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 50/84 [00:01<00:01, 26.04it/s]Scanning Parquet Files:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 51/84 [00:01<00:01, 29.39it/s]Scanning Parquet Files:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 53/84 [00:01<00:01, 27.57it/s]Scanning Parquet Files:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 53/84 [00:01<00:01, 27.52it/s]Scanning Parquet Files:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 54/84 [00:01<00:01, 27.01it/s]Scanning Parquet Files:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 56/84 [00:01<00:00, 28.13it/s]Scanning Parquet Files:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 56/84 [00:01<00:00, 28.08it/s]Scanning Parquet Files:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 55/84 [00:01<00:01, 27.00it/s]Scanning Parquet Files:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 57/84 [00:02<00:01, 23.56it/s]Scanning Parquet Files:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 58/84 [00:01<00:00, 26.92it/s]Scanning Parquet Files:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 60/84 [00:02<00:00, 24.65it/s]Scanning Parquet Files:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 59/84 [00:02<00:01, 21.71it/s]Scanning Parquet Files:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 59/84 [00:02<00:01, 21.40it/s]Scanning Parquet Files:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 61/84 [00:02<00:01, 22.10it/s]Scanning Parquet Files:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 62/84 [00:02<00:00, 23.00it/s]Scanning Parquet Files:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 62/84 [00:02<00:00, 22.52it/s]Scanning Parquet Files:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 63/84 [00:02<00:00, 24.16it/s]Scanning Parquet Files:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 65/84 [00:02<00:00, 24.17it/s]Scanning Parquet Files:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 65/84 [00:02<00:00, 24.22it/s]Scanning Parquet Files:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 65/84 [00:02<00:00, 24.97it/s]Scanning Parquet Files:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 66/84 [00:02<00:00, 23.85it/s]Scanning Parquet Files:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 68/84 [00:02<00:00, 24.75it/s]Scanning Parquet Files:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 68/84 [00:02<00:00, 25.33it/s]Scanning Parquet Files:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 68/84 [00:02<00:00, 24.60it/s]Scanning Parquet Files:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 69/84 [00:02<00:00, 24.64it/s]Scanning Parquet Files:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 71/84 [00:02<00:00, 25.65it/s]Scanning Parquet Files:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 71/84 [00:02<00:00, 25.71it/s]Scanning Parquet Files:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 71/84 [00:02<00:00, 25.98it/s]Scanning Parquet Files:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 72/84 [00:02<00:00, 25.48it/s]Scanning Parquet Files:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 74/84 [00:02<00:00, 26.56it/s]Scanning Parquet Files:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 74/84 [00:02<00:00, 26.55it/s]Scanning Parquet Files:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 74/84 [00:02<00:00, 26.68it/s]Scanning Parquet Files:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 75/84 [00:02<00:00, 26.15it/s]Scanning Parquet Files:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 78/84 [00:02<00:00, 25.30it/s]Scanning Parquet Files:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 78/84 [00:02<00:00, 25.32it/s]Scanning Parquet Files:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 78/84 [00:02<00:00, 25.13it/s]Scanning Parquet Files:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 78/84 [00:02<00:00, 25.40it/s]Scanning Parquet Files:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 82/84 [00:02<00:00, 23.32it/s]Scanning Parquet Files:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 82/84 [00:02<00:00, 23.27it/s]Scanning Parquet Files:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 82/84 [00:03<00:00, 23.15it/s]Scanning Parquet Files:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 82/84 [00:02<00:00, 23.48it/s]Scanning Parquet Files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 84/84 [00:03<00:00, 26.24it/s]
Scanning Parquet Files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 84/84 [00:02<00:00, 28.24it/s]
Scanning Parquet Files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 84/84 [00:02<00:00, 28.54it/s]
Scanning Parquet Files: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 84/84 [00:02<00:00, 29.27it/s]
‚úÖ Loaded 233515 samples.
‚úÖ Loaded 233515 samples.
‚úÖ Loaded 233515 samples.
‚úÖ Loaded 233515 samples.
Filtered dataset: 233360 samples remaining.
Filtered dataset: 233360 samples remaining.
Filtered dataset: 233360 samples remaining.
Filtered dataset: 233360 samples remaining.
/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/utils/data/sampler.py:76: UserWarning: `data_source` argument is not used and will be removed in 2.2.0.You may still have custom implementation that utilizes it.
  warnings.warn(
/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/utils/data/sampler.py:76: UserWarning: `data_source` argument is not used and will be removed in 2.2.0.You may still have custom implementation that utilizes it.
  warnings.warn(
/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/utils/data/sampler.py:76: UserWarning: `data_source` argument is not used and will be removed in 2.2.0.You may still have custom implementation that utilizes it.
  warnings.warn(
/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/utils/data/sampler.py:76: UserWarning: `data_source` argument is not used and will be removed in 2.2.0.You may still have custom implementation that utilizes it.
  warnings.warn(
01/27/2026 02:01:24 - INFO - __main__ - [INFO] resume_from_checkpoint is None, but checking for existing checkpoints in /home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps...
01/27/2026 02:01:24 - INFO - __main__ - [INFO] No checkpoints found in /home/v-yuxluo/data/experiments/260127_qwenimage_20b_5000steps, starting fresh
W0127 02:10:37.031000 3525249 site-packages/torch/distributed/elastic/agent/server/api.py:704] Received Signals.SIGTERM death signal, shutting down workers
W0127 02:10:37.033000 3525249 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3525506 closing signal SIGTERM
W0127 02:10:37.034000 3525249 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3525507 closing signal SIGTERM
W0127 02:10:37.036000 3525249 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3525508 closing signal SIGTERM
W0127 02:10:37.037000 3525249 site-packages/torch/distributed/elastic/multiprocessing/api.py:897] Sending process 3525509 closing signal SIGTERM
Traceback (most recent call last):
  File "/home/v-yuxluo/miniconda3/envs/flux2/bin/accelerate", line 7, in <module>
    sys.exit(main())
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/accelerate/commands/accelerate_cli.py", line 50, in main
    args.func(args)
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/accelerate/commands/launch.py", line 1268, in launch_command
    multi_gpu_launcher(args)
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/accelerate/commands/launch.py", line 899, in multi_gpu_launcher
    distrib_run.run(args)
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/distributed/run.py", line 910, in run
    elastic_launch(
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 138, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 260, in launch_agent
    result = agent.run()
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/distributed/elastic/metrics/api.py", line 137, in wrapper
    result = f(*args, **kwargs)
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 696, in run
    result = self._invoke_run(role)
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/distributed/elastic/agent/server/api.py", line 855, in _invoke_run
    time.sleep(monitor_interval)
  File "/home/v-yuxluo/miniconda3/envs/flux2/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 84, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 3525249 got signal: 15
